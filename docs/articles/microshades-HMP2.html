<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Human Microbiome Project 2 • microshades</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Human Microbiome Project 2">
<meta property="og:description" content="microshades">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-196876408-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-196876408-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microshades</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/microshades-CMD.html">Curated Metagenomic Data</a>
    </li>
    <li>
      <a href="../articles/microshades-GP.html">Global Patterns Data</a>
    </li>
    <li>
      <a href="../articles/microshades-HMP.html">Human Microbiome Project</a>
    </li>
    <li>
      <a href="../articles/microshades-HMP2.html">Human Microbiome Project 2</a>
    </li>
    <li>
      <a href="../articles/non-microbiome_data.html">Palmer Penguins Data Example</a>
    </li>
    <li>
      <a href="../articles/titanic_data_example.html">Titanic Data Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KarstensLab/microshades/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="microshades-HMP2_files/header-attrs-2.5/header-attrs.js"></script><link href="microshades-HMP2_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="microshades-HMP2_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Human Microbiome Project 2</h1>
                        <h4 class="author">Erin Dahl</h4>
            
            <h4 class="date">July 15, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KarstensLab/microshades/blob/master/vignettes/microshades-HMP2.Rmd"><code>vignettes/microshades-HMP2.Rmd</code></a></small>
      <div class="hidden name"><code>microshades-HMP2.Rmd</code></div>

    </div>

    
    
<div id="human-microbiome-project-2-data-vignette" class="section level1">
<h1 class="hasAnchor">
<a href="#human-microbiome-project-2-data-vignette" class="anchor"></a>Human Microbiome Project 2 Data Vignette</h1>
<p>This vignette uses 16s rRNA sequencing data from the Human Microbiome Project 2. Vaginal microbiome samples from moms will be examined in this tutorial at the Phylum &amp; Genus taxonomic levels.</p>
<p>This data is available in the HMP2Data library. To download use <code><a href="https://rdrr.io/pkg/BiocManager/man/install.html">BiocManager::install("HMP2Data")</a></code>.</p>
<p>Learn more about the HMP2 Data <a href="https://bioconductor.org/packages/release/data/experiment/html/HMP2Data.html">here</a></p>
<div id="load-the-necessary-packages-for-this-toutorial" class="section level2">
<h2 class="hasAnchor">
<a href="#load-the-necessary-packages-for-this-toutorial" class="anchor"></a>Load the necessary packages for this toutorial</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jstansfield0/HMP2Data">HMP2Data</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217">phyloseq</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment">SummarizedExperiment</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://waldronlab.io/MultiAssayExperiment/">MultiAssayExperiment</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://karstenslab.github.io/microshades">microshades</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="load-the-hmp2-data-as-a-phyloseq-object" class="section level2">
<h2 class="hasAnchor">
<a href="#load-the-hmp2-data-as-a-phyloseq-object" class="anchor"></a>Load the HMP2 data as a phyloseq object</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the momspi16S data </span>
<span class="va">ps_momspi16S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HMP2Data/man/momspi16S.html">momspi16S</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">ps_momspi16S</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 7665 taxa and 9107 samples ]
## sample_data() Sample Data:       [ 9107 samples by 13 sample variables ]
## tax_table()   Taxonomy Table:    [ 7665 taxa by 7 taxonomic ranks ]</code></pre>
<p>The <code>ps_momspi16S</code> object contains 9,107 samples. To focus on a smaller sample size, use phyloseq function <code><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html">subset_samples()</a></code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Subset the samples</span>
<span class="va">ps_momspi16S_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html">subset_samples</a></span><span class="op">(</span><span class="va">ps_momspi16S</span>,<span class="va">sample_body_site</span> <span class="op">==</span> <span class="st">"vagina"</span><span class="op">)</span>
<span class="va">ps_momspi16S_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html">subset_samples</a></span><span class="op">(</span><span class="va">ps_momspi16S_sub</span>, <span class="va">visit_number</span> <span class="op">==</span> <span class="fl">9</span><span class="op">)</span>

<span class="va">ps_momspi16S_sub</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 7665 taxa and 22 samples ]
## sample_data() Sample Data:       [ 22 samples by 13 sample variables ]
## tax_table()   Taxonomy Table:    [ 7665 taxa by 7 taxonomic ranks ]</code></pre>
</div>
<div id="apply-microshades-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#apply-microshades-functions" class="anchor"></a>Apply microshades functions</h2>
<p>Now that the sample size is reduced (22 samples), begin using microshades functions to evaluate abundance and apply advanced color organization.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use microshades function prep_mdf to agglomerate, normalize, and melt the phyloseq object</span>
<span class="va">mdf_prep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_mdf.html">prep_mdf</a></span><span class="op">(</span><span class="va">ps_momspi16S_sub</span><span class="op">)</span>

<span class="co"># Create a color object for the specified data</span>
<span class="va">color_objs_momspi16S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_color_dfs.html">create_color_dfs</a></span><span class="op">(</span><span class="va">mdf_prep</span>, cvd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Extract</span>
<span class="va">mdf_momspi16S_unordered</span> <span class="op">&lt;-</span> <span class="va">color_objs_momspi16S</span><span class="op">$</span><span class="va">mdf</span>
<span class="va">cdf_momspi16S</span> <span class="op">&lt;-</span> <span class="va">color_objs_momspi16S</span><span class="op">$</span><span class="va">cdf</span></code></pre></div>
<div id="plot" class="section level3">
<h3 class="hasAnchor">
<a href="#plot" class="anchor"></a>Plot</h3>
<p>The dataframe <code>mdf_momspi16S_unordered</code> contains sample data and abundance info. The dataframe <code>cdf_momspi16S</code> stores the color mapping information used for plotting.</p>
<p><code>plot_microshades</code> produces a stacked barplot with ordered subgroup taxonomy. The darkest shade is the most abundant, and the lightest shade is the least abundant. (excluding the “other” subgroup from each of the selected groups)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_microshades.html">plot_microshades</a></span><span class="op">(</span><span class="va">mdf_momspi16S_unordered</span>, <span class="va">cdf_momspi16S</span><span class="op">)</span>

<span class="va">plot_1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm"</span><span class="op">)</span>, text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="microshades-HMP2_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
</div>
<div id="order-the-samples-by-lactobacillus-abundance" class="section level2">
<h2 class="hasAnchor">
<a href="#order-the-samples-by-lactobacillus-abundance" class="anchor"></a>Order the samples by Lactobacillus Abundance</h2>
<p>The plot above indicates that Lactobacillus is the most abundant genera in the Firmicutes phyla in this dataset. To see samples arranged in order of Lactobacillus abundance (or any genus listed in the legend above) use the <code><a href="../reference/reorder_samples_by.html">reorder_samples_by()</a></code> function and then plot.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># reorder_samples_by will change the order of samples based on an abundance of a specified subgroup taxonomy</span>
<span class="co"># The default subgroup_level is "Genus" and the specified subgroup taxonomy to order by is "Lactobacillus"</span>
<span class="va">momspi16S_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reorder_samples_by.html">reorder_samples_by</a></span><span class="op">(</span><span class="va">mdf_momspi16S_unordered</span>,<span class="va">cdf_momspi16S</span>, order <span class="op">=</span> <span class="st">"Lactobacillus"</span><span class="op">)</span>

<span class="va">mdf_momspi16S_ordered</span> <span class="op">&lt;-</span> <span class="va">momspi16S_ordered</span><span class="op">$</span><span class="va">mdf</span>
<span class="va">cdf_momspi16S_ordered</span> <span class="op">&lt;-</span> <span class="va">momspi16S_ordered</span><span class="op">$</span><span class="va">cdf</span>

<span class="va">plot_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_microshades.html">plot_microshades</a></span><span class="op">(</span><span class="va">mdf_momspi16S_ordered</span>, <span class="va">cdf_momspi16S_ordered</span><span class="op">)</span>

<span class="va">plot_2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html">expansion</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm"</span><span class="op">)</span>, text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="microshades-HMP2_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Erin Dahl, Lisa Karstens, Emory Neer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
