<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Remove NA Option â€¢ microshades</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Remove NA Option">
<meta property="og:description" content="microshades">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-196876408-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-196876408-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microshades</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/microshades-GP.html">Global Patterns Data</a>
    </li>
    <li>
      <a href="../articles/microshades-HMP.html">Human Microbiome Project</a>
    </li>
    <li>
      <a href="../articles/microshades-legend_customization.html">Legend Customization</a>
    </li>
    <li>
      <a href="../articles/microshades-sample_reordering.html">Sample Reordering</a>
    </li>
    <li>
      <a href="../articles/non-microbiome_data.html">Palmer Penguins Data Example</a>
    </li>
    <li>
      <a href="../articles/remove_na_option.html">Remove NA Option</a>
    </li>
    <li>
      <a href="../articles/titanic_data_example.html">Titanic Data Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KarstensLab/microshades/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Remove NA Option</h1>
                        <h4 data-toc-skip class="author">Anagha Shenoy,
Lisa Karstens</h4>
            
            <h4 data-toc-skip class="date">June 6, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KarstensLab/microshades/blob/HEAD/vignettes/remove_na_option.Rmd" class="external-link"><code>vignettes/remove_na_option.Rmd</code></a></small>
      <div class="hidden name"><code>remove_na_option.Rmd</code></div>

    </div>

    
    
<p>The <code>microshades</code> package allows for color organization in
data visualizations, particularly visualizations of microbiome data.
Relative abundance plots are common to microbiome investigations as they
present an informative overview of the bacterial composition of
samples.</p>
<p>Previously, the default <code>microshades</code> behavior in versions
1.1 and earlier was such that NA values in the input data (a phyloseq
object) were ignored. That is, relative abundances were calculated as
though bacteria that are not identified taxonomically are not present in
the sample. For more details on the issue and origin of the behavior,
see <a href="https://github.com/KarstensLab/microshades/issues/18" class="external-link">issue
18</a>.</p>
<p>The default behavior of <code>microshades</code> in versions 1.11 and
later is NOT to remove NA values. If users wish to remove NAs , the
<code>prep_mdf</code> function has a <code>remove_na</code> parameter to
allow users to specify whether or not NA values should be removed from
the data during the taxa agglomeration step.</p>
<p>Removal of NA values can affect interpretation of data depending on
what dataset is examined. The following example demonstrates this in
addition to demonstrating how to remove NAs when using microshades.</p>
<div class="section level2">
<h2 id="load-packages-data">Load packages &amp; data<a class="anchor" aria-label="anchor" href="#load-packages-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://karstenslab.github.io/microshades" class="external-link">microshades</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217" class="external-link">phyloseq</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The dataset Global Patterns is a phyloseq object available from the Phyloseq package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GlobalPatterns</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-to-generate-default-plot-with-nas">Code to generate default plot with NAs<a class="anchor" aria-label="anchor" href="#code-to-generate-default-plot-with-nas"></a>
</h2>
<p><code>mdf_GP_updated</code> is the object to be plotted. It contains
the abundance information organized by taxa (phylum and genus in this
example), with NA values not removed. <code>cdf_GP_updated</code> will
be used for coloring the plot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdf_updated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_mdf.html">prep_mdf</a></span><span class="op">(</span><span class="va">GlobalPatterns</span><span class="op">)</span> <span class="co"># prep_mdf function to agglomerate, normalize, melt</span></span>
<span></span>
<span><span class="co"># Create abundance dataframe &amp; color mapping dataframe</span></span>
<span><span class="va">color_objs_GP_updated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_color_dfs.html">create_color_dfs</a></span><span class="op">(</span><span class="va">mdf_updated</span>, </span>
<span>                                  selected_groups <span class="op">=</span> </span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Verrucomicrobia"</span>, <span class="st">"Proteobacteria"</span>, <span class="st">"Actinobacteria"</span>, <span class="st">"Bacteroidetes"</span>,</span>
<span>                                    <span class="st">"Firmicutes"</span><span class="op">)</span>,</span>
<span>                                  cvd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mdf_GP_updated</span> <span class="op">&lt;-</span> <span class="va">color_objs_GP_updated</span><span class="op">$</span><span class="va">mdf</span></span>
<span><span class="va">cdf_GP_updated</span> <span class="op">&lt;-</span> <span class="va">color_objs_GP_updated</span><span class="op">$</span><span class="va">cdf</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Order the samples by Proteobacteria abundance for visual organization</span></span>
<span><span class="va">reordered_GP_update</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reorder_samples_by.html">reorder_samples_by</a></span><span class="op">(</span><span class="va">mdf_GP_updated</span>, </span>
<span>                                          <span class="va">cdf_GP_updated</span>, </span>
<span>                                          order <span class="op">=</span> <span class="st">"Proteobacteria"</span>, </span>
<span>                                          group_level <span class="op">=</span> <span class="st">"Phylum"</span>, </span>
<span>                                          subgroup_level <span class="op">=</span> <span class="st">"Genus"</span>, </span>
<span>                                          sink_abundant_groups <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract dataframes</span></span>
<span><span class="va">mdf_up_GP</span> <span class="op">&lt;-</span> <span class="va">reordered_GP_update</span><span class="op">$</span><span class="va">mdf</span></span>
<span><span class="va">cdf_up_GP</span> <span class="op">&lt;-</span> <span class="va">reordered_GP_update</span><span class="op">$</span><span class="va">cdf</span></span>
<span></span>
<span><span class="va">mdf_up_GP</span> <span class="op">&lt;-</span> <span class="va">mdf_up_GP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">SampleType</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Feces"</span>, <span class="st">"Freshwater"</span>, <span class="st">"Mock"</span>, <span class="st">"Sediment (estuary)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/custom_legend.html">custom_legend</a></span><span class="op">(</span><span class="va">mdf_up_GP</span>, <span class="va">cdf_up_GP</span>, legend_orientation <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span>
<span><span class="va">center_legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">legend</span>, nrow<span class="op">=</span><span class="fl">1</span>, rel_widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.96</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_updated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_microshades.html">plot_microshades</a></span><span class="op">(</span><span class="va">mdf_up_GP</span>, <span class="va">cdf_up_GP</span><span class="op">)</span></span>
<span></span>
<span><span class="va">faceted_plot_updated</span> <span class="op">&lt;-</span> <span class="va">plot_updated</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">SampleType</span>, scales <span class="op">=</span> <span class="st">"free_x"</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">20</span>,<span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, margin<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"NAs not removed by default (microshades v1.11 and later)"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code-to-generate-plot-with-nas-removed">Code to generate plot with NAs removed<a class="anchor" aria-label="anchor" href="#code-to-generate-plot-with-nas-removed"></a>
</h2>
<p>To remove NAs, the <code>remove_NA</code> parameter is set to
<code>TRUE</code> when calling the <code>prep_mdf</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdf_prep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_mdf.html">prep_mdf</a></span><span class="op">(</span><span class="va">GlobalPatterns</span>, remove_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># NAs to be removed</span></span>
<span></span>
<span><span class="co"># Create abundance dataframe &amp; color mapping dataframe</span></span>
<span><span class="va">color_objs_GP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_color_dfs.html">create_color_dfs</a></span><span class="op">(</span><span class="va">mdf_prep</span>, </span>
<span>                                  selected_groups <span class="op">=</span> </span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Verrucomicrobia"</span>, <span class="st">"Proteobacteria"</span>, <span class="st">"Actinobacteria"</span>, <span class="st">"Bacteroidetes"</span>,</span>
<span>                                    <span class="st">"Firmicutes"</span><span class="op">)</span>,</span>
<span>                                  cvd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract dataframes</span></span>
<span><span class="va">mdf_GP</span> <span class="op">&lt;-</span> <span class="va">color_objs_GP</span><span class="op">$</span><span class="va">mdf</span></span>
<span><span class="va">cdf_GP</span> <span class="op">&lt;-</span> <span class="va">color_objs_GP</span><span class="op">$</span><span class="va">cdf</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Order the samples by Proteobacteria abundance for visual organization</span></span>
<span><span class="va">reordered_GP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reorder_samples_by.html">reorder_samples_by</a></span><span class="op">(</span><span class="va">mdf_GP</span>, </span>
<span>                                   <span class="va">cdf_GP</span>, </span>
<span>                                   order <span class="op">=</span> <span class="st">"Proteobacteria"</span>, </span>
<span>                                   group_level <span class="op">=</span> <span class="st">"Phylum"</span>, </span>
<span>                                   subgroup_level <span class="op">=</span> <span class="st">"Genus"</span>, </span>
<span>                                   sink_abundant_groups <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract dataframes</span></span>
<span><span class="va">mdf_re_GP</span> <span class="op">&lt;-</span> <span class="va">reordered_GP</span><span class="op">$</span><span class="va">mdf</span></span>
<span><span class="va">cdf_re_GP</span> <span class="op">&lt;-</span> <span class="va">reordered_GP</span><span class="op">$</span><span class="va">cdf</span></span>
<span></span>
<span><span class="va">mdf_re_GP</span> <span class="op">&lt;-</span> <span class="va">mdf_re_GP</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">SampleType</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Feces"</span>, <span class="st">"Freshwater"</span>, <span class="st">"Mock"</span>, <span class="st">"Sediment (estuary)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">facet_legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/custom_legend.html">custom_legend</a></span><span class="op">(</span><span class="va">mdf_re_GP</span>, <span class="va">cdf_re_GP</span>, legend_orientation <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span>
<span><span class="va">center_facet_legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">facet_legend</span>, nrow<span class="op">=</span><span class="fl">1</span>, rel_widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.96</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_microshades.html">plot_microshades</a></span><span class="op">(</span><span class="va">mdf_re_GP</span>, <span class="va">cdf_re_GP</span><span class="op">)</span></span>
<span></span>
<span><span class="va">faceted_plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">SampleType</span>, scales <span class="op">=</span> <span class="st">"free_x"</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">20</span>,<span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, margin<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"NAs removed by changing na_remove to TRUE"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visual-comparison-of-na-removal">Visual comparison of NA removal<a class="anchor" aria-label="anchor" href="#visual-comparison-of-na-removal"></a>
</h2>
<p>Note that the relative abundances present differently when the NA
values are removed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">faceted_plot_updated</span>, <span class="va">center_legend</span>, rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.25</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="remove_na_option_files/figure-html/default_behavior-1.png" width="1056"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">faceted_plot</span>, <span class="va">center_facet_legend</span>, rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.25</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="remove_na_option_files/figure-html/nondefault_behavior-1.png" width="1056"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Erin Dahl, Emory Neer, Lisa Karstens.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
